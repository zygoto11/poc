<div ng-include="'header.html'"></div>
<nav class="navbar navbar-expand-lg navbar-expand-sm navbar-dark bg-primary py-0">
    <ul class="navbar-nav">
  <form class="form-inline">
    <a class="btn btn-sm btn-primary" href="#!newsortie">Créer une sortie <i class="fa fa-plus-circle"></i></a>
    <!--a class="btn btn-sm btn-primary" href="#!newsortie" type="button">Smaller button</a-->
  </form>	  
	</ul>
</nav>



<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Confirmer la suppression</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        c'est votre dernier mot ?
      </div>
      <div class="modal-footer">
        <a type="button" class="btn btn-secondary" data-dismiss="modal">euh</a>
        <a data-dismiss="modal" data-backdrop="false" type="button" href="#!sorties" ng-click="deletesortie(sortie)" class="btn btn-danger d-block d-sm-inline" ng-if="showdeletesortie===false">
  Je suis sûr 
</a>
      </div>
    </div>
  </div>
</div>
<br>

<div class="container-fluid">
	<div class="row">
		
<!--div class="col-sm-3 d-none d-sm-block">

<div class="card">
<h4 class="card-header">Sorties</h4>
<div class="card-body">

{{sorties.length}} Sorties
<hr>
<h4>Filtres</h4>
<div class="form-check abc-checkbox  abc-checkbox-primary form-check-inline">
                        <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
                        <label class="form-check-label" for="inlineCheckbox1"> Aujourd'hui </label>
                    </div>
                    <div class="form-check abc-checkbox abc-checkbox-primary form-check-inline">
                        <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option1" checked>
                        <label class="form-check-label" for="inlineCheckbox2"> Dans la semaine </label>
                    </div><hr>

			<div class="btn-group btn-group-toggle">
<label class="btn btn-secondary active" uib-btn-radio="'walking'" ng-model="newsortie.icon"><i class="fa fa-walking"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'beer'" ng-model="newsortie.icon"><i class="fa fa-beer"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'utensils'" ng-model="newsortie.icon"><i class="fa fa-utensils"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'film'" ng-model="newsortie.icon"><i class="fa fa-film"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'chess'" ng-model="newsortie.icon"><i class="fa fa-chess"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'theater-masks'" ng-model="newsortie.icon"><i class="fa fa-theater-masks"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'music'" ng-model="newsortie.icon"><i class="fa fa-music"></i></label>
</div>
<div class="alert alert-info" ng-if="newsortie.icon">
<span ng-if="newsortie.icon ==='beer'">Apéro</span>
<span ng-if="newsortie.icon ==='utensils'">Restaurant</span>
<span ng-if="newsortie.icon ==='walking'">Sport</span>
<span ng-if="newsortie.icon ==='film'">Cinéma</span>
<span ng-if="newsortie.icon ==='chess'">Jeux</span>
<span ng-if="newsortie.icon ==='theater-masks'">Theatre</span>
<span ng-if="newsortie.icon ==='music'">Concert</span>
</div>

<div style="display:inline-block; min-height:290px;">
      <div uib-datepicker ng-model="dt" datepicker-options="options"></div>
    </div>

</div>
</div>



</div-->	
				
<div class="col-sm-3">


			<a type="button" class="btn btn-danger d-block d-sm-inline" data-toggle="modal" data-target="#exampleModal" ng-if="showdeletesortie===false">
			   Supprimer cette sortie ? <i class="fa fa-trash-alt"></i>
			</a>

<form class="form">
        <div class="form-group">
            <input type="text" ng-model="search" class="form-control" placeholder="Rechercher une sortie">
        </div>
		<div class="form-group">
		<ul uib-pagination total-items="totalItems" items-per-page= "itemsPerPage" ng-model="currentPage" ng-change="pageChanged()" previous-text="Précédent" next-text="Suivant"></ul>
		</div>
    </form>

<table class="table table-condensed table-sm">
    <thead class="thead-light">
      <tr>
        <th>Date</th>
        <th>Sortie</th>
        <th>Inscrits</th>
		<th>Organisateur</th>
      </tr>
    </thead>

	
    <tbody ng-repeat="group in (filteredsorties = (sorties | orderBy : 'date' | filter: search)).slice((currentPage -1) * itemsPerPage, currentPage * itemsPerPage) | groupBy : 'date' ">

	<tr class="table-primary"><td colspan=3>{{group[0].timestamp | pgtimestamp | date:'EEEE dd MMMM yyyy'}}<td></tr>
	
      <tr ng-repeat="x in group">
        <td><span class="badge badge-secondary"> <i class="fa fa-clock"></i> {{x.timestamp | pgtimestamp | date:'HH:mm'}}</span></td>
        <td><a href="#!sorties/{{x.id}}"><small>{{x.name}} </small><i class="fa fa-{{x.icon}}"></i></a></td>
        <td><i class="fa fa-lock text-danger" ng-if="x.scope==='private'"></i> 2/12</td>
		<td>	 <span ng-repeat="user in users | filter:{'id': x.leader}:true">{{user.username}} 
			   <img height="40px" class="img img-rounded img-responsive" src="{{user.avatar}}" onMouseOver="this.class=''"></img>
			   <i ng-if="user.gender==='male'" class="fa fa-user text-primary"></i>
			   <i ng-if="user.gender==='female'" class="fa fa-user text-pink"></i>
	</span></td>
      </tr>
	  </tbody>
	  </table>

	  

					
</div>

<div class="col-sm-9" ng-if="!sortie && !shownewsortie">

  <div class="container">
<h4>Dernières photos</h4>
On reconnait bien carca lol
  <div class="row text-center text-lg-left">

    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/pWkk7iiCoDM/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/aob0ukAYfuI/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/EUfxH-pze7s/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/M185_qYH8vg/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/sesveuG_rNo/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/AvhMzHwiE_0/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/2gYsZUmockw/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/EMSDtjVHdQ8/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/8mUEy0ABdNE/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/G9Rfc1qccH4/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/aJeH0KcFkuc/400x300" alt="">
          </a>
    </div>
    <div class="col-lg-3 col-md-4 col-xs-6">
      <a  class="d-block mb-4 h-100">
            <img class="img-fluid img-thumbnail" src="https://source.unsplash.com/p2TQ-3Bh3Oo/400x300" alt="">
          </a>
    </div>
  </div>

</div>

</div>


<div class="col-sm-6" ng-if="sortie">
<h2 class="text-center">{{descsortie[0].name}}</h2>
Date: <span class="badge badge-info">{{descsortie[0].timestamp | pgtimestamp | date:'EEEE dd MMMM yyyy'}}</span><br>
Heure: <span class="badge badge-info">{{descsortie[0].timestamp | pgtimestamp | date:'HH:mm'}}</span><br>
Organisateur 
<span class="badge badge-info" ng-repeat="user in users | filter:{'id': descsortie[0].leader}:true">{{user.username}} 
<img class="img-responsive" height="120px" class="img-fluid img-thumbnail" src="{{user.avatar}}" onMouseOver="this.class=''"></img>
</span>

<br>
Description : <span>{{descsortie[0].description}}</span><br>


<hr>


<hr>
<h3>Commentaires <i class="fa fa-comments"></i></h3>
<br>
<div class="col-md">


<div class="row" ng-repeat="comment in comments | orderBy: timestamp : reverse" ng-class-odd="'alert-info'" ng-class-even="'alert-primary'">
        	    <div class="col-md-2" ng-repeat="user in users | filter:{'username': comment.username}:true">
        	        <img  src="{{user.avatar}}" height="50px" class="img img-responsive"/>
										
        	        <small class="text-secondary">{{comment.timestamp  | pgtimestamp | date:'EEEE dd MMMM yyyy (hh:mm)'}}</small>
					<p><a class="float-left" href="#!members/{{comment.username}}"><strong>{{comment.username}}</strong></a></p>
        	    </div>
        	    <div class="col-md-10">

        	       <div class="clearfix"></div>
        	        <div class="alert">{{comment.comment}}</div>

        	    </div>
	        </div>
			
			
 
</div>

<div class="form-group">
  <textarea ng-model="comment" class="form-control" rows="5" id="comment" placeholder="Ajouter un commentaire..."></textarea><br>
  <a class="float-right btn btn-outline-primary ml-2" ng-click="addcomment(descsortie[0].id,comment)"> <i class="fa fa-reply"></i> Envoyer</a>
</div><br><br>
  
  </div>
  
<div class="col-sm-3" ng-if="sortie">

<h3>Inscrits</h3>

{{inscriptions.length}} Inscrits pour cette sortie<br>

<span ng-repeat="inscrit in inscriptions" ><small class="badge badge-primary">{{inscrit.username}}</small> </span>


<hr>
<a type="button"  class="btn btn-success d-block d-sm-inline" ng-click="register(sortie)">
  S'inscrire <i class="fa fa-plus-circle"></i>
</a> 
<a type="button" class="btn btn-danger d-block d-sm-inline" ng-click="unregister(sortie)">
  Se désinscrire <i class="fa fa-minus-circle"></i>
</a>
<hr>

  <div id="demo" class="carousel slide col-md" data-ride="carousel">
 <ol class="carousel-indicators">
    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
  </ol>
  <!-- The slideshow -->
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="https://picsum.photos/300/300/?random">
    </div>
    <div class="carousel-item">
      <img src="https://picsum.photos/299/300/?random">
    </div>
    <div class="carousel-item">
      <img src="https://picsum.photos/298/300/?random">
    </div>
  </div>
  


  <!-- Left and right controls -->
  <a class="carousel-control-prev" data-target="#demo" data-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </a>
  <a class="carousel-control-next" data-target="#demo" data-slide="next">
    <span class="carousel-control-next-icon"></span>
  </a>

</div>

</div>
  


		<div class="col-md" ng-if="shownewsortie">	
			<form name="createsort">
				<div class="form-group">
					<input type="text" ng-model="newsortie.name" class="form-control" id="formGroupExampleInput" placeholder="Nom de la sortie" required>
				</div> 
				<hr>
				<fieldset>
                    <legend>
                        Visibilité
                    </legend>
                    <div class="form-check abc-radio abc-radio-info form-check-inline">
                        <input ng-model="newsortie.scope" class="form-check-input" type="radio" id="inlineRadio1" value="public" name="radioScope" required>
                        <label class="form-check-label" for="inlineRadio1"> Tout le monde </label>
                    </div>
                    <div class="form-check abc-radio abc-radio-info form-check-inline">
                        <input ng-model="newsortie.scope" class="form-check-input" type="radio" id="inlineRadio2" value="private" name="radioScope" required>
                        <label class="form-check-label" for="inlineRadio2"> Mes amis <i class="fa fa-lock text-danger"></i> </label>
                    </div>
                </fieldset>
				<hr>
				

				
				<div class="btn-group btn-group-toggle">
<label class="btn btn-secondary active" uib-btn-radio="'walking'" ng-model="newsortie.icon"><i class="fa fa-walking"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'beer'" ng-model="newsortie.icon"><i class="fa fa-beer"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'utensils'" ng-model="newsortie.icon"><i class="fa fa-utensils"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'film'" ng-model="newsortie.icon"><i class="fa fa-film"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'chess'" ng-model="newsortie.icon"><i class="fa fa-chess"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'theater-masks'" ng-model="newsortie.icon"><i class="fa fa-theater-masks"></i></label>
<label class="btn btn-secondary active" uib-btn-radio="'music'" ng-model="newsortie.icon"><i class="fa fa-music"></i></label>
</div>
<div class="alert alert-info" ng-if="newsortie.icon">
<span ng-if="newsortie.icon ==='beer'">Apéro</span>
<span ng-if="newsortie.icon ==='utensils'">Restaurant</span>
<span ng-if="newsortie.icon ==='walking'">Sport</span>
<span ng-if="newsortie.icon ==='film'">Cinéma</span>
<span ng-if="newsortie.icon ==='chess'">Jeux</span>
<span ng-if="newsortie.icon ==='theater-masks'">Theatre</span>
<span ng-if="newsortie.icon ==='music'">Concert</span>
</div>
				
				<hr>
				<div class="form-group">
					<input ng-model="newsortie.date" type="date" class="form-control" id="formGroupExampleInput" placeholder="Date" required>
				</div>
				<div class="form-group">
					<input ng-model="newsortie.time" type="time" class="form-control" id="formGroupExampleInput" placeholder="Time" required>
					 					 
				</div>
				<hr>
				 <textarea ng-model="newsortie.desc" class="form-control" placeholder="Description de la sortie" required></textarea>
				<hr>
				
				<input type="text" placeholder="Emplacement de la sortie" ng-model="newsortie.location" uib-typeahead="poi as poi.name for poi in poilist | filter:{name:$viewValue}"  class="form-control" typeahead-show-hint="true" typeahead-min-length="1">
				<br><br>
				<button type="button" ng-disabled="createsort.$invalid" ng-click="createsortie(newsortie.name,newsortie.desc,newsortie.date,newsortie.time,newsortie.icon,newsortie.scope)" class="btn btn-secondary">Créér <i class="fa fa-plus-square"></i></button>	
			</form>	
			<hr>
			<div class="alert alert-info">debug :{{newsortie}}</div>
		</div>


</div>
</div>
